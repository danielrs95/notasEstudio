# Building an ETH blockchain app 1

## What is a blockchain

- Technology used to avoid third parties on exchanges
- Bitcoin is a implementation of blockchain, blockchain = technology, bitcoin = implementation

- Blockchain is a secure way to handle transactions in a trustless environment

### Why use a blockchain?

- Value without trust
- Eliminate middlemen and reduce costs
- Efficiency through direct interaction
- Complete transaction history, transparency
- Resilience through replication

### Blockchain data & blocks

- Cant CRUD, blockchain only allows add & read
- History and auditing capability, like one long ledger

### Blockchain immutability

- Consensus, nodes must agree how to allow new blocks to be added
- Consensus is achieved when more than half of nodes agree

### Hashes

- One way mathematical functions
- Easy to calculate, difficult to revert
- Maps an input to an output
- Any change to hashed data will change the hash result

Hashes allow the blockchain, every block store the hash of the previous block

- If data on the previous block change, his hash will also change, this makes the whole blockchain to break

### Nonce

- Nonce is used as an extra input to add complexity to the hash calculation therefore preventing fake blocks
- Nonce usually is a number, that modifies the hash. For example, bitcoin uses 19 zeros on its hash, so we have to find a number that in combination with the data creates the hash
- Finding the nonce is called MINING

### Arriving at consensus

- Proof of Work

  - Nodes compete to find the nonce
  - First get reward
  - Each node validates de nonce find

- Proof os Stake

  - Less computing power
  - Every node submits a bet
  - Size of bet used to select the winner
  - Selection is random, richest does not always win

- Delegated Proof os Stake

  - Modified PoS
  - Candidate nodes selected like PoS
  - Makes it more fair

- Delegated Byzantine Fault Tolerance (dBFT)
  - Byzantine Generals Problem
  - Group of nodes elect a delegate
  - Speaker randomly chosen from delegates, calculates hash
  - If at least 2/3 of delegates agree with the hash, block is added

## What is Ethereum

- Bitcoin

  - Implementation of blockchain
  - 1st generation blockchain
  - Primarily for cryptocurrency, little support for autonomy

- Ethereum
  - 2nd generation blockchain
  - Native cryptocurrency
  - Smart contracts, more autonomy!

### Ethereum Features

- Transparent transactions, easy auditing
- Traceable history of data, all kind of assets
- Reduce overhead, eliminate middlemen (disintermediation)
- Automate decisions with smart contracts

### Ethereum in financial services

- Pure currency exchanges, easy transfer of digital currency
- Banking, fiat currency must be backed by government
- Cryptocurrency, no government backing. Can create your own tokens (basically smart contracts)
- Blockchain works well transferring assets like real state

### Ethereum in digital identity management

- Identification is making a claim to an identity, authentication is proving that identity
- Ethereum could potentially be used to link real world identities and digital identities, making it difficult for your identity to be stolen
- The ERC-725 standard is a way to link real world identities and eth accounts

### Smart Contracts

- Rules to register a transaction in the blockchain
- Ethereum creates special runtime environment for smart contracts, EVM (Ethereum Virtual Machine) -> Virtual machine means it runs within another operating system
- Every node runs every smart contract
- Smart contracts are deterministic, the output of a smart contract is the same on all nodes
- Smart contracts create rules that must be followed by every node in order to access the blockchain

### ETH & the initial coin offering (ICO)

- ETH is ethereum cryptocurrency
- An ethereum address is a private and public key

### Decentralized Autonomous Organization (DAO)

- Operates with little to no human interaction
- DAO decisions are made by smart contracts

### Ethereum Development Tools

- Development environment
- Testing environment, ensure it works as intended
- Client interface -> Smart contracts are almost only functions, so we need an interface to test it

As Ethereum Development Tools we need:

1. Blockchain client, basically an EVM
2. An environment to develop and test the blockchain
   1. Develop apps using a local blockchain
   2. Test apps using a test blockchain (testnet) ex: Ropsten, Kovan, Rinkeby
3. Deploy to mainnet
4. Compiler
5. Testing framework: Tools to compile smart contract bytecode, push code to test network, invoke functions

- Blockchain apps are different because of their decentralized storage and processing, and append-only data
- Have built in integrity
- Bugs will be there forever because data is immutable

## Ethereum Ecosystem and Development Life Cycle

### Parts of the Ethereum blockchain

- dApps

  - Decentralized apps
  - Used to interact with the blockchain

- Blocks

  - Primary component of the blockchain
  - Stores transactions and smart contract code

- Miners

  - Nodes that create blocks and solve consensus

- Nonce (Number used once)

- Uncle (ommer block)

  - A solution to a block that comes right behind the first miner on solve the problem
  - Miner gets a discounted reward, there are like 5-6 uncle blocks but does not stay on the blockchain there are just for keep miners incentives

- Header, attributes of the entire block.

  - parentHash: Previous hash
  - nonce: Number miners find
  - timestamp: Time
  - ommersHash: uncle blocks
  - logsBloom: Bloom filters (search about)
  - difficulty: difficulty at the time the block was created
  - gasLimit & gasUse: what we pay
  - Roots, 3 pointers, point to the rest of the block
    ![1](/images/13_1.png)

- Block transactions (body), this have their own structure
  - signature: Digital signature, associate with the owner the from account
  - nonce: for each transaction
    ![2](/images/13_2.png)

### Virtual Machines

- Use computers to do more with less hardware
- Easy switch between operating systems or configurations
- Easy to rollback to undo changes with snapshots

- Ethereum uses its runtime as the EVM
  - This means that when you implement a node, you download and install the EVM
  - It is a software application that creates a closed environment and the smart contracts work and they run inside that environment
  - The EVM is present in all nodes
  - All EVM play by the same rules
    - Any node that breaks the rules creates a rogue blockchain -> (smart contracts are deterministic, meaning, they also produce the same result)
    - Any EVM deviation in immediately evident
    - The blockchain of a bad EVM is deemed invalid

### Gas

- Cryptocurrency cost of accessing the blockchain
- Incentivize storing local blockchain copies and mining
- Transaction fee
- Avoid infinite loops because the gas is limited
- Set max amount of gas
  - Incentives developers to create efficient smart contracts
  - They want to reduce the times they interact with the blockchain
  - Reduces malicious code and DoS attacks (Denial of Services)

#### Gas Prices

1. Gas used -> Amount used
2. Gas price
3. Total cost -> Gas used x gas price = total gas
4. The unit used is WEI -> 1 ETH = 1e18 WEI (1 quintillion - 1 with 18 zeros after)
   1. ![3](images/13_3.png)

### Ethereum SDLC (Software Development Life Cycle)

1. Planning
2. Coding - Development
3. Testing
4. Deploy to mainnet

The tools we will use for the SDLC

1. Ethereum blockchain client
2. Development/testing blockchain
3. Compiler/testing framework
4. Source code editor - IDE (Integrated Development Environment)

### Blockchain client

- Software app that makes a device a node on the Ethereum blockchain
- Supports Ethereum standards
- Runs the EVM on a node

![4](images/13_4.png)

### Writing and testing your code

- By default the client connect to the mainnet
- We have to attached to a local simulated blockchain for our development and testing

![5](images/13_5.png)

- Frameworks help by simplifying deployment and testing tasks

![6](images/13_6.png)

## ETH development toolbox

- Your ETH development toolbox consists of your blockchain client (EVM), IDEs for code development, local and public test blockchains, and the live environment (mainnet)
- ETH has a vast amount of open-source tools on the main page

![7](images/13_7.png)
